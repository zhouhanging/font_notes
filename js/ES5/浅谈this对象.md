---
title: 浅谈this对象
date: 2021-08-14
categories:
 - JavaScript
---

在普通函数里面，this是运行时进行绑定的，它的上下文取决于函数调用时的各种条件。

每个函数的this是在调用时被绑定，完全取决于函数的调用位置（也就是函数的调用方法）

那么什么是调用位置呢？调用位置就是函数在代码中被调用的位置，并非是声明的位置。

我们寻找调用位置，其最重要的是分析调用栈，我们关心的调用位置就是当前正在执行的函数的前一个调用中。

绑定规则
### 默认绑定
最常用的函数调用类型：独立函数调用，


### 隐式绑定
调用位置是否有上下文对象，或者说是否被某个对象拥有或者包含。当函数引用有上下文对象时，饮食绑定规则会把函数调用中的this绑定到这个上下对象

### 隐式丢失
一个最常见的this绑定问题就是被隐式绑定的函数会丢失绑定对象，也就是说它会应用默认绑定，从而把this绑定到全局对象或者undefined上。将一个函数作为参数传递时，也会发生

### 显示绑定
像call、apply这样，如果第一个参数是原始值，那么这个原始值会被转换成它的对象形式

### new绑定
创建一个新对象并把它绑定到函数中的this上

优先级
new -> 显示绑定 -> 隐式绑定 -> 默认绑定


对于显示绑定那里，如果第一个参数是null或者undefined，在调用时被忽略，采用默认绑定规则

间接引用，我们有可能（有意或无意地）创建一个函数的“间接引用”，在这种情况下，调用这个函数会应用默认绑定规则。

`(p.foo = q.foo)()` 这个会采用默认绑定的规则

软绑定：



箭头函数不使用this的四种标准规则，而是根据外层（函数或全局）作用域来决定this


判断一个运行中函数的this绑定，就需要找到这个函数的直接调用位置，找到之后就按照绑定规则来判断this的绑定对象。
1. 由new调用，那么绑定到新创建的对象
2. 由call、apply、bind调用？绑定到指定的对象
3. 由上下文对象调用？绑定到那个上下文对象
4. 默认：严格模式下绑定到undefined，否则绑定到全局对象。

箭头函数并不会使用上面四条标准的绑定规则，而是根据当前的词法作用域来决定this。



