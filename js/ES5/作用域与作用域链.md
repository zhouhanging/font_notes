---
title: 作用域与作用域链
date: 2021-07-13
categories: 
 - JavaScript
---

## 概述
作用域指的是程序代码中定义变量的区域，规定了如何如何查找变量。

当执行一段可执行js代码时，会创建相应的执行上下文，每个上下文都会有三个重要的属性：变量对象VO，作用域链scope和this。查找变量的时候，会先从当前执行上下文的变量对象开始查找，如果没有找到，就会从父级执行上下文的变量对象中查找，一直找到全局上下文的变量对象，这样由多个执行上下文的变量对象构成的链式关系就叫做作用域链。

那么是如何知道当前执行上下文的父级上下文呢？原因在于js采用的是静态作用域，在函数定义的时候就决定了函数的作用域。每个函数对象内部都会有一个`[[scope]]`属性，在函数创建的时候，就会保存所有父上下文的变量对象到这个属性。当进入函数的时候，会创建一个活动对象，这个活动对象会保存这个函数里面的所有变量，然后将这个活动对象放到这个scope属性的首位，也就是作用域链的顶部。


## 预编译
在执行函数之前，会先创建函数执行上下文，然后使用arguments和命名参数初始化一个活动对象，然后寻找函数里面的函数声明，进行提升，再找变量声明进行提升。